# Archive-Markdown-Editor

---

## 一. 软件简介
Archive Markdown Editor是一款基于Electron的，编写与渲染分离（非所见即所得）的Markdown编辑器，相较于其他Markdown编辑器，Archive Markdown Editor具有其他编辑器所没有的特性。如：
1. 独创性推出基于Markdown的拓展格式：mdz。可方便进行多媒体归档，设置密码等操作。
2. 在遵循原有Markdown语法规范（CommonMark和GitHub Flavored Markdown）不变的情况下，支持通过Archive Markdown Editor特有的拓展语法插入视频和音频（后续版本会加入PDF、docx、pptx、xlsx等常见类型文件的支持）。
3. 智能提示，使您编写Markdown时更舒适。
4. **注意⚠️！如果您有跨编辑器编辑Markdown文档的需求，请不要在Markdown内容中使用Archive Markdown Editor特有的拓展语法，保存文件时请不要保存为mdz格式！**

另外，通过页面局部更新，减小渲染压力，可顺利打开10000-20000行的Markdown并进行查看&编辑，性能强于Mark Text和Typora。

## 二. 软件安装
### 1. 下载编译好的binary直接安装
进入Archive Markdown Editor的GitHub项目，从“Release”中下载最新版本的binary file，按照各系统的常用安装方式进行安装。

### 2. 自行编译安装
本项目中内置macOS arm64和Windows x64版本的编译打包程序

## 三. 提升Markdown易用性的新格式：*.mdz

### 1. 介绍
1. 传统Markdown插入多媒体的本质是插入指定多媒体的位置信息（包括在线网址/离线文件路径），Markdown并未与多媒体文件强绑定，易出现多媒体丢失的问题，影响Markdown文章的阅读。
2. 该格式能在Markdown中有效嵌入图片、视频、音频等多媒体文件（包括PDF、docx、pptx、xlsx等常见类型，后续版本将会推出）。
3. 该文件格式本质是Zip压缩包，扩展名由原来的*.zip改成了*.mdz，名称来源：Markdown + Zip。本格式能将多媒体文件和Markdown有机结合，打包在一起，以后与人共享包含多媒体的Markdown文件时，仅需共享一个文件即可，不需要为零散的多媒体文件费心。
4. 由于微软Office的*.docx文件过于笨重不灵活，且难以插入视频和音频（\*.pptx都可以随便插入视频和音频等多媒体，且能和多媒体一起打包进文件内部，搞不懂微软内部在干啥，不给\*.docx支持一下），因此我们亟需一种兼顾Markdown的轻巧灵活舒适和pptx对多媒体较强归档能力的格式。因此，*.mdz横空出世！

### 2. 文件格式细节
1. 扩展名为*.mdz，如：file_name.mdz
2. 本质为Zip，将扩展名*.mdz改成*.zip后，可轻易用解压软件解压。而正是因为本质为zip，因此拥有zip节省文件大小、便于归档多文件、应用范围广、易于传输、可设置密码以提高安全性等特点。
3. 解压后的文件结构如下：

```text
file_name
    └── mdz_contents
        ├── file_name.md
        └── media_src
                 └── media.jpg
    
```
其中“file_name.md”是我们熟悉的Markdown文件，**该文件的名字和原来的mdz文件名一致**。media_src文件用于存放多媒体。

### 3. 编辑器在保存新建的*.mdz文件时的处理过程细节
保存新建的文件时，编辑器将在用户指定的保存目录生成mdz文件结构（不可见文件夹），将编辑的内容保存至这个文件结构（即文件夹）中，在该目录打包成mdz文件，最后删除文件结构。

### 4. 编辑器在打开已有的*.mdz文件时的处理过程细节
编辑器在mdz文件所在目录解压mdz文件，解压后的文件夹在系统不可见，文件夹名称格式如：._mdz_content.file_name，关闭mdz文件时，在该目录删除解压的文件夹。

### 5. 编辑器在保存/另存为更改后已有的*.mdz文件时的处理过程细节
编辑器在保存时，将更改后的内容写入第4节提到的文件夹中，然后进行打包压缩，保存至打开文件时所在的目录，并更改扩展名为mdz。另存为只是多了将Markdown文件名和文件夹名更改为用户指定文件名，并保存于用户指定目录。

### 6. 编辑器处理多媒体文件路径时的细节
#### 6.1. 在新建的文件中插入路径指定方式为绝对/相对路径的多媒体，最后保存为Markdown格式时
多媒体文件路径不改变。
#### 6.2. 在新建的文件中插入路径指定方式为绝对/相对路径的多媒体，最后保存为mdz格式时
编辑器将多媒体拷贝至用户指定的保存目录生成的mdz文件结构中，并将多媒体文件路径自动改为mdz专属多媒体文件路径，如：
```text
![图片](/path/to/media.png)
```
当保存为mdz格式时，内容就会变成：
```text
![图片]($MDZ_MEDIA/media.png)
```
#### 6.3. 打开已有的Markdown文件，插入路径指定方式为绝对/相对路径的多媒体，最后保存为Markdown文件：
同6.1。
#### 6.4. 打开已有的Markdown文件，插入路径指定方式为绝对/相对路径的多媒体，最后另存为mdz文件：
同6.2。
#### 6.5. 打开已有的mdz文件，插入路径指定方式为绝对/相对路径的多媒体，最后另存为Markdown文件：
编辑器会在原mdz目录中新建形如“file_name.media_src”文件夹，然后会将mdz文件中用专属路径引用的多媒体拷贝至“file_name.media_src”文件夹，然后将mdz文件中用专属路径改为“./file_name.media_src/media.png”相对路径。插入的绝对/相对路径不改变。
#### 6.6. 打开已有的mdz文件，插入路径指定方式为绝对/相对路径的多媒体，最后保存为mdz文件：
同6.2，且mdz文件中用专属路径不改变。
#### 6.7. 注意事项⚠️
任何通过在线URL进行标记的多媒体，无论保存为Markdown还是mdz，编辑器均不会更改其内容。